import{r as t,h as s}from"./p-33b9aa6b.js";import{Logger as i,I18n as e}from"@aws-amplify/core";import{M as a}from"./p-417bb5ea.js";import{Auth as h}from"@aws-amplify/auth";import{T as l}from"./p-956a9917.js";import{N as n,e as o,f as r}from"./p-900152ca.js";const p=new i("SelectMFAType"),u=class{constructor(s){t(this,s),this.handleSubmit=t=>this.verify(t),this.TOTPSetup=!1,this.selectMessage=null,this.MFAMethod=null,this.isTOTP=!1,this.isNoMFA=!1,this.isSMS=!1,this.loading=!1,this.isToastVisible=!1}componentWillLoad(){console.warn("Version `1.x` of Amplify UI has been deprecated and will be removed in a future major version of `aws-amplify`. Please visit https://ui.docs.amplify.aws/ for the current version of Amplify UI.")}handleRadioButtonChange(t){this.TOTPSetup=!1,this.selectMessage=null,this.isNoMFA=!1,this.isTOTP=!1,this.isSMS=!1,this.isToastVisible=!1;const{value:s,type:i,checked:e}=t.target,h=["radio","checkbox"].includes(i);s===a.SMS&&h&&(this.isSMS=e),s===a.TOTP&&h&&(this.isTOTP=e),s===a.NOMFA&&h&&(this.isNoMFA=e)}async verify(t){t&&t.preventDefault(),p.debug("MFA Type Values",{TOTP:this.isTOTP,SMS:this.isSMS,"No MFA":this.isNoMFA}),this.isTOTP?this.MFAMethod=a.TOTP:this.isSMS?this.MFAMethod=a.SMS:this.isNoMFA&&(this.MFAMethod=a.NOMFA);const s=this.authData;if(!h||"function"!=typeof h.setPreferredMFA)throw new Error(n);this.loading=!0;try{const t=await h.setPreferredMFA(s,this.MFAMethod);p.debug("Set Preferred MFA Succeeded",t),this.selectMessage=`${e.get(l.SUCCESS_MFA_TYPE)} ${this.MFAMethod}`}catch(i){const{message:t}=i;t===o||t===r?(this.TOTPSetup=!0,this.selectMessage=e.get(l.SETUP_TOTP_REQUIRED)):(p.debug("Set Preferred MFA failed",i),this.selectMessage=e.get(l.UNABLE_TO_SETUP_MFA_AT_THIS_TIME))}finally{this.loading=!1,this.isToastVisible=!0}}contentBuilder(){if(!this.MFATypes||Object.keys(this.MFATypes).length<2)return p.debug(e.get(l.LESS_THAN_TWO_MFA_VALUES_MESSAGE)),s("div",null,s("a",null,e.get(l.LESS_THAN_TWO_MFA_VALUES_MESSAGE)));const{SMS:t,TOTP:i,Optional:a}=this.MFATypes;return s("amplify-form-section",{submitButtonText:e.get(l.SELECT_MFA_TYPE_SUBMIT_BUTTON_TEXT),headerText:e.get(l.SELECT_MFA_TYPE_HEADER_TEXT),handleSubmit:t=>this.handleSubmit(t),loading:this.loading},t?s("amplify-radio-button",{key:"sms",name:"MFAType",value:"SMS",label:"SMS",handleInputChange:t=>this.handleRadioButtonChange(t)}):null,i?s("amplify-radio-button",{key:"totp",name:"MFAType",value:"TOTP",label:"TOTP",handleInputChange:t=>this.handleRadioButtonChange(t)}):null,a?s("amplify-radio-button",{key:"noMFA",name:"MFAType",value:"NOMFA",label:"No MFA",handleInputChange:t=>this.handleRadioButtonChange(t)}):null)}renderToast(){return this.isToastVisible&&this.selectMessage?s("amplify-toast",{message:this.selectMessage,handleClose:()=>{this.selectMessage=null,this.isToastVisible=!1}}):null}render(){return s("div",null,this.contentBuilder(),this.TOTPSetup?s("amplify-totp-setup",{user:this.authData}):null,this.renderToast())}};export{u as amplify_select_mfa_type}