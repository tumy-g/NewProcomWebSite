import{r as o,h as t}from"./p-33b9aa6b.js";import{ConsoleLogger as i,I18n as e}from"@aws-amplify/core";import{A as n}from"./p-417bb5ea.js";import{Auth as s}from"@aws-amplify/auth";import{T as a}from"./p-956a9917.js";import{N as r,h as c}from"./p-900152ca.js";import{d as l}from"./p-5298f93e.js";const h=new i("amplify-amazon-button"),f=class{constructor(t){o(this,t),this.handleAuthStateChange=l,this.federatedSignIn=o=>{const{access_token:t,expires_in:i}=o;if(!t)return;if(!s||"function"!=typeof s.federatedSignIn||"function"!=typeof s.currentAuthenticatedUser)throw new Error(r);const e=1e3*i+(new Date).getTime();window.amazon.Login.retrieveProfile(async o=>{if(!o.success)return h.debug("Get user Info failed");const i={name:o.profile.Name,email:o.profile.PrimaryEmail};await s.federatedSignIn("amazon",{token:t,expires_at:e},i);const a=await s.currentAuthenticatedUser();this.handleAuthStateChange(n.SignedIn,a)})}}componentWillLoad(){console.warn("Version `1.x` of Amplify UI has been deprecated and will be removed in a future major version of `aws-amplify`. Please visit https://ui.docs.amplify.aws/ for the current version of Amplify UI.")}signInWithAmazon(o){o.preventDefault(),window.amazon.Login.setClientId(this.clientId),window.amazon.Login.authorize({scope:"profile"},o=>{if(o.error)return h.debug("Failed to login with amazon: "+o.error);try{window.localStorage.setItem(c,JSON.stringify({provider:"amazon"}))}catch(t){h.debug("Failed to cache auth source into localStorage",t)}this.federatedSignIn(o)})}render(){return t("amplify-sign-in-button",{onClick:o=>this.signInWithAmazon(o),provider:"amazon"},t("script",{src:"https://assets.loginwithamazon.com/sdk/na/login1.js"}),e.get(a.SIGN_IN_WITH_AMAZON))}},p=new i("amplify-auth0-button"),u=class{constructor(t){o(this,t),this.handleAuthStateChange=l,this.handleLoad=()=>{const{oauth:o={}}=s.configure(),{config:t=o.auth0}=this;t?(p.debug("auth0 configuration",t),this._auth0||(this._auth0=new window.auth0.WebAuth(t)),this._auth0.parseHash((o,i)=>{if(o)return void p.debug("Failed to parse the url for Auth0",o);if(!i)return void p.debug("Auth0 found no authResult in hash");const e={provider:"auth0",opts:{returnTo:t.returnTo,clientID:t.clientID,federated:t.federated}};try{localStorage.setItem(c,JSON.stringify(e))}catch(a){p.debug("Failed to cache auth source into localStorage",a)}this._auth0.client.userInfo(i.accessToken,async(o,e)=>{let a=void 0,r=void 0;o?p.debug("Failed to get the user info",o):(a=e.name,r=e.email),await s.federatedSignIn(t.domain,{token:i.idToken,expires_at:1e3*i.expiresIn+(new Date).getTime()},{name:a,email:r});const c=await s.currentAuthenticatedUser();this.handleAuthStateChange(n.SignedIn,c)})})):p.debug("Auth0 is not configured")}}componentWillLoad(){console.warn("Version `1.x` of Amplify UI has been deprecated and will be removed in a future major version of `aws-amplify`. Please visit https://ui.docs.amplify.aws/ for the current version of Amplify UI.")}signInWithAuth0(o){if(o.preventDefault(),!this._auth0)throw new Error("the auth0 client is not configured");this._auth0.authorize()}render(){return t("amplify-sign-in-button",{onClick:o=>this.signInWithAuth0(o),provider:"auth0"},t("script",{onLoad:this.handleLoad,src:"https://cdn.auth0.com/js/auth0/9.11/auth0.min.js"}),e.get(a.SIGN_IN_WITH_AUTH0))}},m=new i("amplify-facebook-button"),d=class{constructor(t){o(this,t),this.handleAuthStateChange=l,this.federatedSignIn=o=>{const{accessToken:t,expiresIn:i}=o;if(!t)return;if(!s||"function"!=typeof s.federatedSignIn||"function"!=typeof s.currentAuthenticatedUser)throw new Error(r);const e=1e3*i+(new Date).getTime();window.FB.api("/me",{fields:"name,email"},async o=>{const i={name:o.name,email:o.email};await s.federatedSignIn("facebook",{token:t,expires_at:e},i);const a=await s.currentAuthenticatedUser();this.handleAuthStateChange(n.SignedIn,a)})},this.getLoginStatus=()=>{window.FB.getLoginStatus(o=>{try{window.localStorage.setItem(c,JSON.stringify({provider:"facebook"}))}catch(t){m.debug("Failed to cache auth source into localStorage",t)}if("connected"===o.status)return this.federatedSignIn(o.authResponse);this.login()})},this.login=()=>{window.FB.login(o=>{o&&o.authResponse&&this.federatedSignIn(o.authResponse)},{scope:"public_profile,email"})}}componentWillLoad(){console.warn("Version `1.x` of Amplify UI has been deprecated and will be removed in a future major version of `aws-amplify`. Please visit https://ui.docs.amplify.aws/ for the current version of Amplify UI.")}signInWithFacebook(o){o.preventDefault(),window.FB.init({appId:this.appId,cookie:!0,xfbml:!1,version:"v5.0"}),this.getLoginStatus()}render(){return t("amplify-sign-in-button",{onClick:o=>this.signInWithFacebook(o),provider:"facebook"},t("script",{async:!0,defer:!0,src:"https://connect.facebook.net/en_US/sdk.js"}),e.get(a.SIGN_IN_WITH_FACEBOOK))}},w=new i("amplify-google-button"),y=class{constructor(t){o(this,t),this.handleAuthStateChange=l,this.handleError=o=>{console.error(o)},this.handleLoad=()=>{window.gapi.load("auth2")},this.handleUser=async o=>{if(!s||"function"!=typeof s.federatedSignIn||"function"!=typeof s.currentAuthenticatedUser)throw new Error(r);try{window.localStorage.setItem(c,JSON.stringify({provider:"google"}))}catch(l){w.debug("Failed to cache auth source into localStorage",l)}const{id_token:t,expires_at:i}=o.getAuthResponse(),e=o.getBasicProfile();await s.federatedSignIn("google",{token:t,expires_at:i},{email:e.getEmail(),name:e.getName(),picture:e.getImageUrl()});const a=await s.currentAuthenticatedUser();try{this.handleAuthStateChange(n.SignedIn,a)}catch(h){this.handleError(h)}}}componentWillLoad(){console.warn("Version `1.x` of Amplify UI has been deprecated and will be removed in a future major version of `aws-amplify`. Please visit https://ui.docs.amplify.aws/ for the current version of Amplify UI.")}getAuthInstance(){return window.gapi&&window.gapi.auth2?window.gapi.auth2.getAuthInstance()||window.gapi.auth2.init({client_id:this.clientId,cookiepolicy:"single_host_origin",scope:"profile email openid"}):null}signInWithGoogle(o){o.preventDefault(),this.getAuthInstance().signIn().then(this.handleUser).catch(this.handleError)}render(){return t("amplify-sign-in-button",{onClick:o=>this.signInWithGoogle(o),provider:"google"},t("script",{onLoad:this.handleLoad,src:"https://apis.google.com/js/api:client.js"}),e.get(a.SIGN_IN_WITH_GOOGLE))}},g=class{constructor(t){o(this,t),this.config={}}signInWithOAuth(o){o.preventDefault(),s.federatedSignIn()}componentWillLoad(){console.warn("Version `1.x` of Amplify UI has been deprecated and will be removed in a future major version of `aws-amplify`. Please visit https://ui.docs.amplify.aws/ for the current version of Amplify UI.")}render(){return t("amplify-sign-in-button",{onClick:o=>this.signInWithOAuth(o),provider:"oauth"},this.config.label||e.get(a.SIGN_IN_WITH_AWS))}};export{f as amplify_amazon_button,u as amplify_auth0_button,d as amplify_facebook_button,y as amplify_google_button,g as amplify_oauth_button}